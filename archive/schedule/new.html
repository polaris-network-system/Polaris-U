<section class="m-3">
    <div class="hero is-info">
        <div class="hero-body">
            <p class="title">新規部活日程登録</p>
        </div>
    </div>
    <div class="m-6">
        <!-- フォームの部品 -->
        <div class="my-4">
            <label for="date">活動日</label>
            <input type="datetime-local" id="date" name="date" class="input" />
        </div>
        <div class="my-4">
            <label for="title">活動内容</label>
            <input type="text" id="title" name="title" class="input" placeholder="活動内容を簡潔に入力" />
        </div>
        <div class="my-4">
            <label for="place">活動場所</label>
            <input type="text" id="place" name="place" class="input" placeholder="活動場所を入力" />
        </div>
        <div class="my-4">
            <label for="message">特記事項</label>
            <input type="text" id="message" name="message" class="input" placeholder="特記事項を入力" />
        </div>
        <input type="submit" value="登録する" class="button is-outline is-info" id="btn" />
    </div>
</section>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
    var btn = document.getElementById('btn');
    btn.addEventListener('click', function () {
        btn.value = '送信中...';
        $(function () {
            google.script.run
                .withSuccessHandler(showThings)
                .sendData(
                    'schedule_new',
                    document.getElementById('date').value,
                    document.getElementById('title').value,
                    document.getElementById('place').value,
                    document.getElementById('message').value
                );
        });
    });
    function showThings(things) {
        message = '成功しました\n名前：' + things[0] + '\n日時：' + things[1];
        window.alert(message);
        document.getElementById('date').value = '';
        document.getElementById('title').value = '';
        document.getElementById('place').value = '';
        document.getElementById('message').value = '';
        btn.value = '登録する';
    }
</script>
