<section class="m-3">
  <div class="hero">
    <div class="hero-body">
      <p class="title">機材情報更新</p>
    </div>
  </div>
  <div class="m-6">
      <!-- フォームの部品 -->
      <div class="my-4">
            <label for="id">機材ID</label>
            <input type="text" id="id" name="id" class="input" placeholder="購入(作成)年下２桁＋コード＋ナンバー">
      </div>
      <input type="submit" value="照会" class="button is-outline is-info" id="btn_inquiry"><br><br>
      <strong id="result" class="has-text-danger"></strong>
      <div class="my-4">
            <label for="name">登録名</label>
            <input type="text" id="name" name="name" class="input" disabled>
      </div>
      <div class="my-4">
            <label for="status">状態</label>
            <input type="text" id="status" name="status" class="input" placeholder="状態を入力">
      </div>
      <div class="my-4">
            <label for="message">付加事項</label>
            <input type="text" id="message" name="message" class="input" placeholder="付加事項を入力">
      </div>
      <div class="my-4">
            <label for="content">特記事項</label>
            <textarea type="text" id="content" name="content" class="input" placeholder="特記事項を入力" style="height: 150px;"></textarea>
      </div>
      <input type="submit" value="登録情報更新" class="button is-outline is-info" id="btn" disabled>
  </div>
</section>
<script
  src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script>
<script>
  var btn_inquiry = document.getElementById('btn_inquiry');
  btn_inquiry.addEventListener('click', function() {
    btn_inquiry.value = "照会中..."
    $(function() {
    google.script.run.withSuccessHandler(showThings_inquiry)
        .getData("item_inquery",document.getElementById('id').value);
    });
  })
  function showThings_inquiry(things) {
    if(things[0] == "bad"){
      document.getElementById('result').textContent = "入力された機材IDに該当する機材がありません"
      document.getElementById('name').value = ""
      document.getElementById('status').value = ""
      document.getElementById('message').value = ""
      document.getElementById('content').value = ""
      btn_inquiry.value = "照会"
      document.getElementById('btn').disabled = true;
    }else{
      document.getElementById('name').value = things[1]
      document.getElementById('status').value = things[2]
      document.getElementById('message').value = things[3]
      document.getElementById('content').value = things[4]
      btn_inquiry.value = "照会"
      document.getElementById('btn').disabled = false;
    }
  }
</script>
<script>
  var btn = document.getElementById('btn');
  btn.addEventListener('click', function() {
    btn.value = "送信中..."
    $(function() {
    google.script.run.withSuccessHandler(showThings)
        .sendData("item_update",document.getElementById('id').value,document.getElementById('name').value,document.getElementById('status').value,document.getElementById('message').value,document.getElementById('content').value);
    });
  })
  function showThings(things) {
    message = "成功しました\nID：" + things[0] + "\n名前：" + things[1]
    window.alert(message)
    btn.value = "登録情報更新"
  }
</script>
